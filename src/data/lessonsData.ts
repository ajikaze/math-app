// 学習ステップの例の型定義
interface Example {
    title: string;
    detail: string;
}

// 学習ステップの落とし穴の型定義
interface Pitfall {
    title: string;
    detail: string;
}

// 練習問題の型定義
export interface Problem {
    question: string;
    answer: string;
    hint: string;
}

// 学習ステップの型定義
export interface LearningStep {
    title: string;
    explanation: string;
    examples?: Example[];
    pitfall: Pitfall;
    problems?: Problem[];
}

// 学習トピックの型定義
export interface LearningTopic {
    topic: string;
    steps: LearningStep[];
}

// 科目データの型定義
interface SubjectData {
    [key: string]: LearningTopic[];
}

// 数学I の学習コンテンツ
const math1Lessons: LearningTopic[] = [
    {
        topic: "式の計算",
        steps: [
            {
                title: "多項式の展開と因数分解",
                explanation: `
            多項式の展開は、分配法則を使って式を広げることです。
            因数分解は、展開の逆で、共通因数でくくったり、公式を使ったりして積の形にすることです。
          `,
                examples: [
                    {
                        title: "展開の例",
                        detail: "$(x+2)(x+3) = x^2 + 3x + 2x + 6 = x^2 + 5x + 6$",
                    },
                    {
                        title: "因数分解の例",
                        detail: "$x^2 + 5x + 6 = (x+2)(x+3)$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：符号ミスや項の漏れ",
                    detail: `
              展開では、すべての項を掛け合わせているか、符号が正しいかを確認しましょう。
              因数分解では、公式を正しく適用できているか、共通因数を見落としていないか注意が必要です。
            `,
                },
                problems: [
                    {
                        question: "$(x+3)(x-2)$ を展開しなさい。",
                        answer: "x^2+x-6",
                        hint: "分配法則を使いましょう。",
                    },
                    {
                        question: "$x^2 - 5x + 6$ を因数分解しなさい。",
                        answer: "(x-2)(x-3)",
                        hint: "掛けて6、足して-5になる2つの数を見つけましょう。",
                    },
                ],
            },
            {
                title: "実数と根号",
                explanation: `
            実数とは、有理数（分数で表せる数）と無理数（分数で表せない数、例：$\\sqrt{2}$, $\\pi$）を合わせたものです。
            根号（ルート）の計算では、$\\sqrt{a}\\sqrt{b} = \\sqrt{ab}$ や $\\frac{\\sqrt{a}}{\\sqrt{b}} = \\sqrt{\\frac{a}{b}}$ などの性質を使います。
            分母の有理化も重要です。
          `,
                examples: [
                    {
                        title: "根号の計算例",
                        detail: "$\\sqrt{12} = \\sqrt{4 \\times 3} = 2\\sqrt{3}$",
                    },
                    {
                        title: "分母の有理化の例",
                        detail: "$\\frac{1}{\\sqrt{2}} = \\frac{1 \\times \\sqrt{2}}{\\sqrt{2} \\times \\sqrt{2}} = \\frac{\\sqrt{2}}{2}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：根号の足し算・引き算",
                    detail: `
              $\\sqrt{2} + \\sqrt{3} = \\sqrt{5}$ のように計算してしまうのは間違いです。
              根号の中の数が同じ場合のみ、係数を足し引きできます。例：$2\\sqrt{3} + 4\\sqrt{3} = 6\\sqrt{3}$
            `,
                },
                problems: [
                    {
                        question: "$\\sqrt{18} + \\sqrt{8}$ を簡単にしなさい。",
                        answer: "5sqrt(2)",
                        hint: "根号の中をできるだけ小さくしましょう。",
                    },
                    {
                        question: "$\\frac{1}{\\sqrt{3}-1}$ を有理化しなさい。",
                        answer: "(sqrt(3)+1)/2",
                        hint: "分母と分子に何を掛ければ良いでしょうか？",
                    },
                ],
            },
        ],
    },
    {
        topic: "方程式と不等式",
        steps: [
            {
                title: "1次方程式・不等式",
                explanation: `
            1次方程式は、$ax+b=0$ の形で表される方程式です。文字を含む項を片側に、定数項をもう片側に集めて解きます。
            1次不等式は、$ax+b>0$ のように不等号で表される式です。方程式と同様に解きますが、負の数を掛けたり割ったりする際には不等号の向きが逆になることに注意が必要です。
          `,
                examples: [
                    {
                        title: "1次方程式の例",
                        detail: "$2x - 3 = 5 \\Rightarrow 2x = 8 \\Rightarrow x = 4$",
                    },
                    {
                        title: "1次不等式の例",
                        detail: "$ -3x < 6 \\Rightarrow x > -2$ （負の数で割ると不等号の向きが逆になる）",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：負の数で割る際の不等号の向き",
                    detail: `
              $-2x > 4$ を解く際に、$x > -2$ としてしまうのは間違いです。
              両辺を負の数 $(-2)$ で割るため、不等号の向きが逆になり、$x < -2$ が正解です。
            `,
                },
                problems: [
                    {
                        question: "$3x - 5 = 7$ を解きなさい。",
                        answer: "x=4",
                        hint: "定数項を右辺に移項しましょう。",
                    },
                    {
                        question: "$2x + 3 < 7$ を解きなさい。",
                        answer: "x<2",
                        hint: "負の数で割る場合に注意しましょう。",
                    },
                ],
            },
            {
                title: "2次方程式",
                explanation: `
            2次方程式は、$ax^2+bx+c=0$ の形で表される方程式です。
            解き方には、因数分解、平方完成、解の公式 ($x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$) があります。
            判別式 $D = b^2-4ac$ の符号によって、実数解の個数が分かります。
          `,
                examples: [
                    {
                        title: "因数分解の例",
                        detail: "$x^2 - 4x + 3 = 0 \\Rightarrow (x-1)(x-3) = 0 \\Rightarrow x=1, 3$",
                    },
                    {
                        title: "解の公式の例",
                        detail: "$x^2 + x - 1 = 0 \\Rightarrow x = \\frac{-1 \\pm \\sqrt{1^2 - 4(1)(-1)}}{2(1)} = \\frac{-1 \\pm \\sqrt{5}}{2}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：解の公式の符号ミス",
                    detail: `
              解の公式の $-b$ や $2a$ の符号、$\\pm$ の後の根号内の計算ミスが多いです。
              特に、判別式 $D$ の計算は慎重に行いましょう。
            `,
                },
                problems: [
                    {
                        question: "$x^2 - 5x + 6 = 0$ を解きなさい。",
                        answer: "x=2,3",
                        hint: "因数分解を試みましょう。",
                    },
                    {
                        question: "$x^2 + 2x - 1 = 0$ を解きなさい。",
                        answer: "-1±sqrt(2)",
                        hint: "解の公式を使いましょう。",
                    },
                ],
            },
            {
                title: "2次不等式",
                explanation: `
            2次不等式は、$ax^2+bx+c>0$ や $ax^2+bx+c \\le 0$ のように不等号で表される式です。
            2次関数のグラフとx軸との位置関係を考えることで解きます。
            下に凸の放物線の場合、$ax^2+bx+c>0$ ならばx軸より上の部分、$ax^2+bx+c<0$ ならばx軸より下の部分に対応します。
          `,
                examples: [
                    {
                        title: "2次不等式の例",
                        detail: "$x^2 - 4 > 0 \\Rightarrow (x-2)(x+2) > 0 \\Rightarrow x < -2, x > 2$",
                    },
                    {
                        title: "グラフによる解法",
                        detail: "2次関数 $y=x^2-4$ のグラフは下に凸で、x軸と $x=-2, 2$ で交わる。$y>0$ となるのは $x<-2$ または $x>2$ の範囲。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：グラフの概形と不等号の向き",
                    detail: `
              2次不等式を解くには、対応する2次方程式の解（x軸との交点）を求め、グラフの概形（上に凸か下に凸か）を正確に把握することが重要です。
              不等号の向きと、グラフのどの部分が条件を満たすのかを混同しないようにしましょう。
            `,
                },
                problems: [
                    {
                        question: "$x^2 - 4x + 3 > 0$ を解きなさい。",
                        answer: "x<1, x>3",
                        hint: "対応する2次方程式の解を求め、グラフを描いてみましょう。",
                    },
                    {
                        question: "$x^2 - 2x - 8 \\le 0$ を解きなさい。",
                        answer: "-2<=x<=4",
                        hint: "因数分解して、x軸との交点を見つけましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "2次関数",
        steps: [
            {
                title: "2次関数のグラフ",
                explanation: `
            2次関数 $y = ax^2 + bx + c$ のグラフは放物線になります。
            特に $y = a(x-p)^2 + q$ の形（標準形）にすると、頂点が $(p, q)$ であることがすぐに分かります。
            $a > 0$ なら下に凸、$a < 0$ なら上に凸のグラフです。
          `,
                examples: [
                    {
                        title: "標準形の例",
                        detail: "$y = 2(x-1)^2 + 3$ の頂点は $(1, 3)$ で、下に凸の放物線です。",
                    },
                    {
                        title: "平方完成の例",
                        detail: "$y = x^2 - 6x + 7 = (x-3)^2 - 9 + 7 = (x-3)^2 - 2$。頂点は $(3, -2)$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：頂点の符号ミス",
                    detail: `
              $y = a(x-p)^2 + q$ の頂点は $(p, q)$ ですが、$y = (x+1)^2 + 2$ の頂点を $(1, 2)$ と間違えることがあります。
              正しくは $(-1, 2)$ です。$(x-p)$ の形に注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "2次関数 $y = (x-3)^2 + 1$ の頂点の座標を求めなさい。",
                        answer: "(3,1)",
                        hint: "標準形 $y = a(x-p)^2 + q$ の頂点は $(p, q)$ です。",
                    },
                    {
                        question:
                            "2次関数 $y = x^2 - 4x + 5$ の頂点の座標を求めなさい。",
                        answer: "(2,1)",
                        hint: "平方完成して標準形にしましょう。",
                    },
                ],
            },
            {
                title: "2次関数の最大・最小",
                explanation: `
            2次関数の最大値・最小値は、グラフの頂点のy座標と、定義域の端点でのy座標を比較して求めます。
            定義域に頂点が含まれるか、定義域がどこからどこまでかをしっかり確認することが重要です。
            グラフを描いて視覚的に考えるのが効果的です。
          `,
                examples: [
                    {
                        title: "定義域内の頂点",
                        detail: "関数 $y = (x-1)^2 + 2$ の $0 \\le x \\le 3$ において、頂点 $(1,2)$ は定義域内。$x=0$ で $y=3$、$x=3$ で $y=6$。よって最大値は6、最小値は2。",
                    },
                    {
                        title: "定義域外の頂点",
                        detail: "関数 $y = (x-3)^2 + 1$ の $0 \\le x \\le 2$ において、頂点 $(3,1)$ は定義域外。$x=0$ で $y=10$、$x=2$ で $y=2$。よって最大値は10、最小値は2。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：定義域の考慮不足",
                    detail: `
              頂点が定義域の外にある場合でも、頂点のy座標を最大値・最小値としてしまう間違いが多いです。
              必ず、定義域の端点での値も計算し、それらと頂点のy座標を比較して、最も大きい値が最大値、最も小さい値が最小値であることを確認しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $y = (x-1)^2 + 2$ の $0 \\le x \\le 3$ における最大値と最小値を求めなさい。",
                        answer: "最大値: 6, 最小値: 2",
                        hint: "グラフの頂点と定義域の端点での値を比較しましょう。",
                    },
                    {
                        question:
                            "関数 $y = -x^2 + 4x + 1$ の $x \\ge 0$ における最大値を求めなさい。",
                        answer: "5",
                        hint: "上に凸のグラフで、頂点がどこにあるかを確認しましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "三角比",
        steps: [
            {
                title: "三角比の定義",
                explanation: `
            直角三角形において、角度に対する辺の比率を三角比と呼びます。
            $\\sin \\theta = \\frac{対辺}{斜辺}$
            $\\cos \\theta = \\frac{隣辺}{斜辺}$
            $\\tan \\theta = \\frac{対辺}{隣辺}$
            これらの定義は、直角三角形の形によらず、角度が同じであれば常に一定です。
          `,
                examples: [
                    {
                        title: "定義の例",
                        detail: "斜辺が5、対辺が3、隣辺が4の直角三角形で、角度が$\\theta$ の場合、$\\sin \\theta = \\frac{3}{5}$, $\\cos \\theta = \\frac{4}{5}$, $\\tan \\theta = \\frac{3}{4}$ となります。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：辺の対応関係の混同",
                    detail: `
              どの辺が「対辺」「隣辺」「斜辺」なのかを、基準となる角度から見て正確に把握することが重要です。
              特に、直角三角形の向きが変わると混乱しやすいので注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "直角三角形ABCで、$\\angle C = 90^\\circ$, AB=5, BC=3, CA=4 のとき、$\\sin A$ の値を求めなさい。",
                        answer: "3/5",
                        hint: "角度Aから見て、対辺と斜辺はどれでしょうか？",
                    },
                    {
                        question:
                            "直角三角形ABCで、$\\angle C = 90^\\circ$, AB=10, BC=6 のとき、$\\cos B$ の値を求めなさい。",
                        answer: "3/5",
                        hint: "三平方の定理でACの長さを求め、角度Bから見て隣辺と斜辺を確認しましょう。",
                    },
                ],
            },
            {
                title: "三角比の相互関係",
                explanation: `
            三角比の間には、次のような重要な関係があります。
            1. $\\sin^2 \\theta + \\cos^2 \\theta = 1$
            2. $\\tan \\theta = \\frac{\\sin \\theta}{\\cos \\theta}$
            3. $1 + \\tan^2 \\theta = \\frac{1}{\\cos^2 \\theta}$
            これらの関係を使うと、一つの三角比の値から他の三角比の値を求めることができます。
          `,
                examples: [
                    {
                        title: "相互関係の例",
                        detail: "$\\sin \\theta = \\frac{3}{5}$ のとき、$\\cos^2 \\theta = 1 - (\\frac{3}{5})^2 = 1 - \\frac{9}{25} = \\frac{16}{25}$。よって $\\cos \\theta = \\frac{4}{5}$ （$\\theta$ が鋭角の場合）。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：象限による符号の変化",
                    detail: `
              三角比の相互関係を使う際、角度がどの象限にあるかによって、$\\sin \\theta$, $\\cos \\theta$, $\\tan \\theta$ の符号が変わることに注意が必要です。
              例えば、$\\cos \\theta$ が負になる場合、$\\sin \\theta = \\sqrt{1 - \\cos^2 \\theta}$ ではなく、$\\sin \\theta = \\pm \\sqrt{1 - \\cos^2 \\theta}$ と考える必要があります。
            `,
                },
                problems: [
                    {
                        question:
                            "$\\sin \\theta = \\frac{3}{5}$ のとき、$\\cos \\theta$ の値を求めなさい。（ただし、$0^\\circ < \\theta < 90^\\circ$）",
                        answer: "4/5",
                        hint: "$\\sin^2 \\theta + \\cos^2 \\theta = 1$ を使いましょう。",
                    },
                    {
                        question:
                            "$\\tan \\theta = 2$ のとき、$\\cos \\theta$ の値を求めなさい。（ただし、$0^\\circ < \\theta < 90^\\circ$）紅",
                        answer: "1/sqrt(5)",
                        hint: "$1 + \\tan^2 \\theta = \\frac{1}{\\cos^2 \\theta}$ を使いましょう。",
                    },
                ],
            },
            {
                title: "正弦定理・余弦定理",
                explanation: `
            三角形ABCにおいて、辺の長さと角度の間には以下の関係があります。
            正弦定理: $\\frac{a}{\\sin A} = \\frac{b}{\\sin B} = \\frac{c}{\\sin C} = 2R$ （Rは外接円の半径）
            余弦定理: $a^2 = b^2 + c^2 - 2bc \\cos A$ （他の辺や角についても同様）
            これらの定理は、直角三角形でない一般的な三角形の辺の長さや角度を求めるのに役立ちます。
          `,
                examples: [
                    {
                        title: "正弦定理の例",
                        detail: "三角形ABCで、$\\angle A = 30^\\circ$, $a=5$, $\\angle B = 45^\\circ$ のとき、$\\frac{5}{\\sin 30^\\circ} = \\frac{b}{\\sin 45^\\circ} \\Rightarrow b = 5 \\frac{\\sin 45^\\circ}{\\sin 30^\\circ} = 5 \\frac{\\frac{\\sqrt{2}}{2}}{\\frac{1}{2}} = 5\\sqrt{2}$",
                    },
                    {
                        title: "余弦定理の例",
                        detail: "三角形ABCで、$b=3, c=4, \\angle A = 60^\\circ$ のとき、$a^2 = 3^2 + 4^2 - 2(3)(4)\\cos 60^\\circ = 9 + 16 - 24(\\frac{1}{2}) = 13$。よって $a=\\sqrt{13}$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：どの定理を使うべきか判断できない",
                    detail: `
              与えられた情報によって、正弦定理と余弦定理のどちらを使うべきか判断に迷うことがあります。
              「向かい合う辺と角のペアが分かっている」場合は正弦定理、
              「2辺とその間の角」または「3辺」が分かっている場合は余弦定理を使うことが多いです。
            `,
                },
                problems: [
                    {
                        question:
                            "三角形ABCで、b=4, $\\angle B = 30^\\circ$, $\\angle A = 45^\\circ$ のとき、辺aの長さを求めなさい。",
                        answer: "4sqrt(2)",
                        hint: "正弦定理を使いましょう。",
                    },
                    {
                        question:
                            "三角形ABCで、b=3, c=5, $\\angle A = 60^\\circ$ のとき、辺aの長さを求めなさい。",
                        answer: "sqrt(19)",
                        hint: "余弦定理を使いましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "データの分析",
        steps: [
            {
                title: "代表値と散らばり",
                explanation: `
            データの代表値には、平均値、中央値（メジアン）、最頻値（モード）があります。
            データの散らばりを表す指標には、範囲、四分位範囲、分散、標準偏差があります。
            これらを使うことで、データの全体的な傾向やばらつき具合を把握できます。
          `,
                examples: [
                    {
                        title: "平均値の例",
                        detail: "データ：1, 2, 3, 4, 5 の平均値は $\\frac{1+2+3+4+5}{5} = 3$ です。",
                    },
                    {
                        title: "中央値の例",
                        detail: "データ：2, 5, 3, 8, 2 を小さい順に並べると 2, 2, 3, 5, 8。中央値は真ん中の値の 3 です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：中央値と平均値の使い分け",
                    detail: `
              外れ値があるデータの場合、平均値は大きく影響を受けますが、中央値は影響を受けにくいです。
              データの特性を理解し、適切な代表値を選ぶことが重要です。
            `,
                },
                problems: [
                    {
                        question:
                            "データ：2, 5, 3, 8, 2 の平均値を求めなさい。",
                        answer: "4",
                        hint: "すべての値を足して、データの個数で割りましょう。",
                    },
                    {
                        question:
                            "データ：2, 5, 3, 8, 2 の中央値を求めなさい。",
                        answer: "3",
                        hint: "データを小さい順に並べ替えて、真ん中の値を見つけましょう。",
                    },
                ],
            },
            {
                title: "相関関係",
                explanation: `
            2つのデータの間に、一方が増えると他方も増える（正の相関）、一方が増えると他方が減る（負の相関）、関係がない（無相関）といった傾向があるとき、それらを相関関係と呼びます。
            散布図を描いたり、相関係数を計算したりすることで、相関の強さや向きを調べることができます。
          `,
                examples: [
                    { title: "正の相関の例", detail: "勉強時間とテストの点数" },
                    {
                        title: "負の相関の例",
                        detail: "スマートフォンの使用時間と睡眠時間",
                    },
                    { title: "無相関の例", detail: "身長と好きな食べ物" },
                ],
                pitfall: {
                    title: "よくある間違い：相関関係と因果関係の混同",
                    detail: `
              相関関係があるからといって、必ずしも一方のデータがもう一方の原因になっている（因果関係がある）とは限りません。
              例えば、「アイスクリームの売上と水難事故の件数に正の相関がある」というデータがあったとしても、アイスクリームが水難事故の原因ではありません。どちらも「気温が高い」という別の要因に影響されているだけです。
            `,
                },
                problems: [
                    {
                        question:
                            "以下の状況で、どのような相関関係が考えられますか？「気温が高くなると、ビールの売上が増える」",
                        answer: "正の相関",
                        hint: "一方が増えると、もう一方も増える関係です。",
                    },
                    {
                        question:
                            "以下の状況で、どのような相関関係が考えられますか？「勉強時間が増えると、ゲームをする時間が減る」",
                        answer: "負の相関",
                        hint: "一方が増えると、もう一方が減る関係です。",
                    },
                ],
            },
        ],
    },
];

// 数学A の学習コンテンツ
const mathALessons: LearningTopic[] = [
    {
        topic: "場合の数と確率",
        steps: [
            {
                title: "順列と組み合わせ",
                explanation: `
            順列は、異なるn個のものからr個を選んで並べる場合の数で、$P(n,r)$ と書きます。並べる順番が重要です。
            組み合わせは、異なるn個のものからr個を選ぶ場合の数で、$C(n,r)$ と書きます。並べる順番は関係ありません。
          `,
                examples: [
                    {
                        title: "順列の例",
                        detail: "5人の生徒から3人を選んで1列に並べる場合：$P(5,3) = 5 \\times 4 \\times 3 = 60$ 通り",
                    },
                    {
                        title: "組み合わせの例",
                        detail: "5人の生徒から3人の委員を選ぶ場合：$C(5,3) = \\frac{5 \\times 4 \\times 3}{3 \\times 2 \\times 1} = 10$ 通り",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：順列と組み合わせの混同",
                    detail: `
              問題文で「並べる」「順番に」といった言葉があれば順列、「選ぶ」「グループを作る」といった言葉があれば組み合わせです。
              どちらを使うべきか、慎重に判断しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "5人の中から3人を選んで1列に並べる方法は何通りありますか？",
                        answer: "60",
                        hint: "これは順列の計算です。",
                    },
                    {
                        question:
                            "5人の中から3人の委員を選ぶ方法は何通りありますか？",
                        answer: "10",
                        hint: "これは組み合わせの計算です。",
                    },
                ],
            },
            {
                title: "確率の基本法則",
                explanation: `
            確率は、ある事象が起こる可能性の度合いを表す数値で、$\\frac{事象の数}{全体の事象の数}$ で求められます。
            和の法則（排反事象の場合）、積の法則（独立事象の場合）などを使って計算します。
          `,
                examples: [
                    {
                        title: "確率の例",
                        detail: "1個のサイコロを投げるとき、1の目が出る確率は $\\frac{1}{6}$ です。",
                    },
                    {
                        title: "和の法則の例",
                        detail: "サイコロで偶数が出る確率（2,4,6）は $\\frac{3}{6} = \\frac{1}{2}$。",
                    },
                    {
                        title: "積の法則の例",
                        detail: "サイコロを2回投げて、2回とも1の目が出る確率は $\\frac{1}{6} \\times \\frac{1}{6} = \\frac{1}{36}$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：排反事象と独立事象の混同",
                    detail: `
              排反事象は「同時に起こらない事象」であり、独立事象は「一方の事象が他方の事象に影響を与えない」事象です。
              それぞれの定義を理解し、適切な法則を適用しないと、確率の計算を間違えてしまいます。
            `,
                },
                problems: [
                    {
                        question:
                            "1個のサイコロを投げるとき、偶数の目が出る確率を求めなさい。",
                        answer: "1/2",
                        hint: "偶数の目はいくつありますか？",
                    },
                    {
                        question:
                            "袋の中に赤玉3個、白玉2個が入っている。この袋から玉を1個取り出し、色を確認して元に戻す。これを2回繰り返すとき、2回とも赤玉が出る確率を求めなさい。",
                        answer: "9/25",
                        hint: "1回目と2回目は独立な事象です。",
                    },
                ],
            },
        ],
    },
    {
        topic: "整数の性質",
        steps: [
            {
                title: "約数と倍数",
                explanation: `
            約数とは、ある数を割り切ることができる整数です。例えば、6の約数は1, 2, 3, 6です。
            倍数とは、ある数を整数倍したものです。例えば、3の倍数は3, 6, 9, ...です。
            最大公約数（GCD）と最小公倍数（LCM）は、複数の数の共通の約数や倍数の中で最大の、または最小のものです。
          `,
                examples: [
                    {
                        title: "約数の例",
                        detail: "10の約数は1, 2, 5, 10です。",
                    },
                    {
                        title: "倍数の例",
                        detail: "4の倍数は4, 8, 12, ...です。",
                    },
                    {
                        title: "最大公約数・最小公倍数の例",
                        detail: "6と9の最大公約数は3、最小公倍数は18です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：素数と合成数の区別",
                    detail: `
              素数は1とその数自身以外に約数を持たない自然数（1は含まない）です。2, 3, 5, 7などが素数です。
              合成数は、素数でない自然数で1より大きいものです。
              素因数分解は、約数や倍数を考える上で非常に重要です。
            `,
                },
                problems: [
                    {
                        question: "12の正の約数をすべて求めなさい。",
                        answer: "1,2,3,4,6,12",
                        hint: "1から順に割れる数を探しましょう。",
                    },
                    {
                        question: "8と12の最大公約数を求めなさい。",
                        answer: "4",
                        hint: "共通の約数の中で一番大きいものです。",
                    },
                ],
            },
            {
                title: "ユークリッドの互除法",
                explanation: `
            ユークリッドの互除法は、2つの自然数の最大公約数を効率的に求めるためのアルゴリズムです。
            「大きい数を小さい数で割った余り」と「小さい数」の最大公約数が、元の2つの数の最大公約数と等しいという性質を利用します。
            余りが0になるまでこの操作を繰り返すと、その時の割る数が最大公約数になります。
          `,
                examples: [
                    {
                        title: "ユークリッドの互除法の例",
                        detail: "24と18の最大公約数：\n$24 = 18 \\times 1 + 6$\n$18 = 6 \\times 3 + 0$\nよって、最大公約数は6。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：計算の途中で止めてしまう",
                    detail: `
              ユークリッドの互除法は、余りが0になるまで計算を続ける必要があります。
              途中で計算を止めてしまうと、正しい最大公約数が得られません。
              また、余りの計算ミスにも注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "105と30の最大公約数をユークリッドの互除法で求めなさい。",
                        answer: "15",
                        hint: "105を30で割った余りは？",
                    },
                    {
                        question:
                            "252と198の最大公約数をユークリッドの互除法で求めなさい。",
                        answer: "18",
                        hint: "計算を繰り返しましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "図形の性質",
        steps: [
            {
                title: "三角形の性質 (重心、外心、内心など)",
                explanation: `
            三角形には、重心、外心、内心、垂心といった特別な点があります。
            重心：中線（頂点と対辺の中点を結ぶ線）の交点。各中線を2:1に内分します。
            外心：各辺の垂直二等分線の交点。外接円の中心です。
            内心：各内角の二等分線の交点。内接円の中心です。
          `,
                examples: [
                    {
                        title: "重心の例",
                        detail: "重心は、三角形の板を指で支えることができる一点です。",
                    },
                    {
                        title: "外心の例",
                        detail: "外心は、三角形の3つの頂点を通る円（外接円）の中心です。",
                    },
                    {
                        title: "内心の例",
                        detail: "内心は、三角形の3つの辺に接する円（内接円）の中心です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：各点の定義の混同",
                    detail: `
              重心、外心、内心、垂心のそれぞれの定義（どの線の交点か）を混同しないように注意しましょう。
              また、それぞれの点が持つ性質（例：外心から各頂点までの距離は等しい）も正確に覚えましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "三角形の3つの中線が交わる点を何と呼びますか？",
                        answer: "重心",
                        hint: "中線が交わる点です。",
                    },
                    {
                        question:
                            "三角形の外接円の中心となる点を何と呼びますか？",
                        answer: "外心",
                        hint: "各辺の垂直二等分線の交点です。",
                    },
                ],
            },
            {
                title: "円の性質 (方べきの定理など)",
                explanation: `
            円には、接線と弦の作る角の定理、方べきの定理など、様々な性質があります。
            方べきの定理は、円と直線が交わる点や接する点に関する辺の長さの関係を示す定理です。
            これらの定理は、図形問題で辺の長さや角度を求めるのに役立ちます。
          `,
                examples: [
                    {
                        title: "方べきの定理の例",
                        detail: "円の外部の点Pから引いた接線PTと、点Pを通る直線が円とA, Bで交わるとき、$PT^2 = PA \\cdot PB$ が成り立ちます。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：定理の適用条件",
                    detail: `
              方べきの定理には、円の内部で交わる場合と外部で交わる場合、接線がある場合など、いくつかのパターンがあります。
              それぞれの定理がどのような図形や条件で適用できるのかを正確に理解しておく必要があります。
            `,
                },
                problems: [
                    {
                        question:
                            "点Pから円に引いた接線の接点をT、点Pを通る直線が円と2点A, Bで交わるとき、成り立つ関係式を答えなさい。",
                        answer: "PT^2 = PA・PB",
                        hint: "方べきの定理を思い出しましょう。",
                    },
                    {
                        question:
                            "円に内接する四角形の対角の和は何度になりますか？",
                        answer: "180度",
                        hint: "円に内接する四角形の性質です。",
                    },
                ],
            },
        ],
    },
];

// 数学II の学習コンテンツ
const math2Lessons: LearningTopic[] = [
    {
        topic: "式と証明",
        steps: [
            {
                title: "整式の除法と分数式",
                explanation: `
            整式の除法は、多項式を多項式で割る計算です。筆算と同様に、割り算の原理「A = BQ + R」が成り立ちます。
            分数式は、分母と分子が多項式である式です。通分や約分、足し算・引き算・掛け算・割り算の計算方法を学びます。
          `,
                examples: [
                    {
                        title: "整式の除法の例",
                        detail: "$(x^2 + 3x + 2)$ を $(x+1)$ で割ると、商は $x+2$、余りは $0$ です。",
                    },
                    {
                        title: "分数式の計算例",
                        detail: "$\\frac{1}{x} + \\frac{1}{x+1} = \\frac{x+1}{x(x+1)} + \\frac{x}{x(x+1)} = \\frac{2x+1}{x(x+1)}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：整式の除法の筆算ミス",
                    detail: `
              整式の除法では、各項の次数を揃えて計算すること、引き算の符号ミスに注意が必要です。
              分数式では、通分する際に分母・分子に同じものを掛けること、約分する際に共通因数で割ることなどを忘れないようにしましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "$(x^3 - 2x^2 + 3x - 1)$ を $(x-1)$ で割った商と余りを求めなさい。",
                        answer: "商: x^2-x+2, 余り: 1",
                        hint: "筆算で計算してみましょう。",
                    },
                    {
                        question:
                            "$\\frac{1}{x+1} + \\frac{1}{x-1}$ を計算しなさい。",
                        answer: "2x/(x^2-1)",
                        hint: "通分しましょう。",
                    },
                ],
            },
            {
                title: "恒等式と等式・不等式の証明",
                explanation: `
            恒等式は、含まれる文字にどのような値を代入しても常に成り立つ等式です。
            等式の証明には、片方の辺を変形してもう片方の辺と一致させる方法や、両辺をそれぞれ変形して同じ式になることを示す方法があります。
            不等式の証明には、$(A-B) \\ge 0$ を示す方法や、相加平均・相乗平均の関係などを利用する方法があります。
          `,
                examples: [
                    {
                        title: "恒等式の例",
                        detail: "$x(x+1) = x^2 + x$ は恒等式です。どんなxを代入しても成り立ちます。",
                    },
                    {
                        title: "不等式の証明例",
                        detail: "$a^2+b^2 \\ge 2ab$ の証明：$(a-b)^2 \\ge 0$ より $a^2 - 2ab + b^2 \\ge 0 \\Rightarrow a^2+b^2 \\ge 2ab$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：恒等式と方程式の混同",
                    detail: `
              恒等式は「常に成り立つ」式であり、方程式は「特定の文字の値で成り立つ」式です。
              恒等式の証明では、係数比較法や数値代入法が有効です。
              不等式の証明では、二乗の形や正負の判断が重要になります。
            `,
                },
                problems: [
                    {
                        question:
                            "次の等式が恒等式となるように、定数a, bの値を求めなさい。$(a+b)x + (a-b) = 4x - 2$",
                        answer: "a=1, b=3",
                        hint: "係数比較法を使いましょう。",
                    },
                    {
                        question:
                            "$a>0, b>0$ のとき、$\\frac{a+b}{2} \\ge \\sqrt{ab}$ を証明しなさい。",
                        answer: "証明略",
                        hint: "両辺を二乗して差を考えてみましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "高次方程式",
        steps: [
            {
                title: "複素数と2次方程式の解",
                explanation: `
            実数では解がない2次方程式 $x^2+1=0$ のような場合を考えるために、虚数単位 $i = \\sqrt{-1}$ を導入します。
            複素数は $a+bi$ の形で表される数で、a, bは実数です。
            2次方程式の解は、判別式が負の場合でも複素数の範囲で2つの解を持つことになります。
          `,
                examples: [
                    {
                        title: "虚数の例",
                        detail: "$i^2 = -1$, $i^3 = -i$, $i^4 = 1$",
                    },
                    {
                        title: "複素数の例",
                        detail: "$x^2 + 4 = 0 \\Rightarrow x^2 = -4 \\Rightarrow x = \\pm 2i$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：虚数単位の計算ミス",
                    detail: `
              $i^2 = -1$ であることを常に意識しましょう。
              複素数の足し算・引き算は実部と虚部をそれぞれ計算し、掛け算は分配法則で展開してから $i^2 = -1$ を適用します。
            `,
                },
                problems: [
                    {
                        question: "$(2+3i) + (1-i)$ を計算しなさい。",
                        answer: "3+2i",
                        hint: "実部と虚部をそれぞれ足し合わせましょう。",
                    },
                    {
                        question: "$(1+i)^2$ を計算しなさい。",
                        answer: "2i",
                        hint: "展開してから $i^2 = -1$ を使いましょう。",
                    },
                ],
            },
            {
                title: "因数定理と高次方程式",
                explanation: `
            因数定理は、多項式 $P(x)$ が $x-k$ で割り切れる（つまり $x-k$ を因数に持つ）ならば、$P(k)=0$ である、という定理です。
            この定理を使うと、3次以上の高次方程式の解を見つけることができます。
            $P(k)=0$ となる $k$ を見つけたら、$(x-k)$ で $P(x)$ を割り算し、次数を下げて解を求めます。
          `,
                examples: [
                    {
                        title: "因数定理の例",
                        detail: "$P(x) = x^3 - 7x + 6$ で $P(1) = 1-7+6 = 0$ なので、$P(x)$ は $(x-1)$ を因数に持ちます。",
                    },
                    {
                        title: "高次方程式の解法例",
                        detail: "$x^3 - 7x + 6 = 0$ の解は、$x=1$ を見つけ、$x^3 - 7x + 6 = (x-1)(x^2+x-6) = (x-1)(x-2)(x+3) = 0$ より $x=1, 2, -3$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：試行錯誤の範囲",
                    detail: `
              $P(k)=0$ となる $k$ を見つける際、闇雲に数を代入するのではなく、定数項の約数を試すのが効率的です。
              例えば、$x^3 + ax^2 + bx + c = 0$ の場合、$c$ の約数（正負両方）を試してみましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "多項式 $P(x) = x^3 - 2x^2 - 5x + 6$ が $x-1$ で割り切れるか調べなさい。",
                        answer: "割り切れる",
                        hint: "$P(1)$ の値を計算してみましょう。",
                    },
                    {
                        question:
                            "方程式 $x^3 - 3x^2 + 4 = 0$ の解を求めなさい。",
                        answer: "x=-1,2(重解)",
                        hint: "定数項4の約数から解を探し、因数分解しましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "図形と方程式",
        steps: [
            {
                title: "点と直線",
                explanation: `
            座標平面上の2点間の距離や、直線の傾き、方程式を学びます。
            2点 $(x_1, y_1)$, $(x_2, y_2)$ 間の距離は $\\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$ です。
            直線の方程式には、$y = mx+n$ （傾きm、y切片n）や $y-y_1 = m(x-x_1)$ （点$(x_1, y_1)$ を通り傾きm）などがあります。
          `,
                examples: [
                    {
                        title: "2点間の距離の例",
                        detail: "点A$(1,2)$ と点B$(4,6)$ の距離は $\\sqrt{(4-1)^2 + (6-2)^2} = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5$ です。",
                    },
                    {
                        title: "直線の方程式の例",
                        detail: "点$(1,2)$ を通り、傾きが3の直線は $y-2 = 3(x-1) \\Rightarrow y = 3x - 3 + 2 \\Rightarrow y = 3x - 1$ です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：傾きの計算ミス",
                    detail: `
              傾きは $\\frac{yの変化量}{xの変化量}$ です。
              計算の際、分子と分母の引き算の順序を間違えないように注意しましょう。
              また、垂直な2直線の傾きの積は $-1$ になる性質も重要です。
            `,
                },
                problems: [
                    {
                        question:
                            "点A$(1,2)$ と点B$(4,6)$ の間の距離を求めなさい。",
                        answer: "5",
                        hint: "距離の公式を使いましょう。",
                    },
                    {
                        question:
                            "点$(2,3)$ を通り、傾きが $-2$ の直線の方程式を求めなさい。",
                        answer: "y=-2x+7",
                        hint: "点と傾きが分かっている直線の方程式の形を思い出しましょう。",
                    },
                ],
            },
            {
                title: "円の方程式",
                explanation: `
            中心が $(a, b)$、半径が $r$ の円の方程式は、$(x-a)^2 + (y-b)^2 = r^2$ です。
            これは、円周上の任意の点 $(x, y)$ と中心との距離が常に半径 $r$ であるという定義から導かれます。
            一般形 $x^2+y^2+lx+my+n=0$ を平方完成して中心と半径を求めることもできます。
          `,
                examples: [
                    {
                        title: "標準形の例",
                        detail: "中心 $(2, -3)$、半径 $5$ の円の方程式は $(x-2)^2 + (y+3)^2 = 5^2 = 25$ です。",
                    },
                    {
                        title: "一般形から標準形への変換例",
                        detail: "$x^2 + y^2 - 4x + 6y - 3 = 0 \\Rightarrow (x^2-4x) + (y^2+6y) = 3 \\Rightarrow (x-2)^2 - 4 + (y+3)^2 - 9 = 3 \\Rightarrow (x-2)^2 + (y+3)^2 = 16$。中心は $(2, -3)$、半径は $4$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：半径の二乗を忘れる",
                    detail: `
              円の方程式の右辺は半径 $r$ ではなく $r^2$ です。
              例えば、半径が3の円の方程式は $(x-a)^2 + (y-b)^2 = 9$ となります。
              また、中心の座標の符号ミスにも注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "中心が $(1, -2)$、半径が $4$ の円の方程式を求めなさい。",
                        answer: "(x-1)^2+(y+2)^2=16",
                        hint: "円の方程式の標準形に当てはめましょう。",
                    },
                    {
                        question:
                            "方程式 $x^2 + y^2 - 6x + 2y + 6 = 0$ が表す円の中心の座標と半径を求めなさい。",
                        answer: "中心:(3,-1), 半径:2",
                        hint: "平方完成して標準形に変形しましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "三角関数",
        steps: [
            {
                title: "三角関数の定義とグラフ",
                explanation: `
            三角関数 $\\sin \\theta$, $\\cos \\theta$, $\\tan \\theta$ は、単位円上の点の座標や傾きで定義されます。
            これらの関数は周期的なグラフを持ちます。
          `,
                examples: [
                    {
                        title: "単位円での定義",
                        detail: "単位円上の点P$(x,y)$ と原点Oを結ぶ線分OPがx軸の正の向きとなす角を$\\theta$ とすると、$x = \\cos \\theta$, $y = \\sin \\theta$, 傾きが $\\tan \\theta$ となります。",
                    },
                    {
                        title: "グラフの周期",
                        detail: "$y = \\sin x$ と $y = \\cos x$ の周期は $2\\pi$（または$360^\\circ$）、$y = \\tan x$ の周期は $\\pi$（または$180^\\circ$）です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：符号の取り違え",
                    detail: `
              単位円のどの象限に角度があるかによって、$\\sin \\theta$, $\\cos \\theta$, $\\tan \\theta$ の符号が変わります。
              これを間違えると、計算結果が大きく変わってしまいます。
            `,
                },
                problems: [
                    {
                        question: "$\\sin(\\frac{\\pi}{2})$ の値を求めなさい。",
                        answer: "1",
                        hint: "単位円上の点(0,1)を考えましょう。",
                    },
                    {
                        question: "関数 $y = \\sin x$ の周期を答えなさい。",
                        answer: "2π",
                        hint: "グラフが繰り返される最小の区間です。",
                    },
                ],
            },
            {
                title: "加法定理",
                explanation: `
            三角関数の加法定理は、2つの角度の和や差の三角関数を、それぞれの角度の三角関数で表す公式です。
            $\\sin(\\alpha + \\beta) = \\sin \\alpha \\cos \\beta + \\cos \\alpha \\sin \\beta$
            $\\cos(\\alpha + \\beta) = \\cos \\alpha \\cos \\beta - \\sin \\alpha \\sin \\beta$
            $\\tan(\\alpha + \\beta) = \\frac{\\tan \\alpha + \\tan \\beta}{1 - \\tan \\alpha \\tan \\beta}$
            これらの公式は、倍角の公式や半角の公式の導出にも使われます。
          `,
                examples: [
                    {
                        title: "加法定理の適用例",
                        detail: "$\\sin(75^\\circ) = \\sin(45^\\circ + 30^\\circ) = \\sin 45^\\circ \\cos 30^\\circ + \\cos 45^\\circ \\sin 30^\\circ = \\frac{\\sqrt{2}}{2} \\cdot \\frac{\\sqrt{3}}{2} + \\frac{\\sqrt{2}}{2} \\cdot \\frac{1}{2} = \\frac{\\sqrt{6} + \\sqrt{2}}{4}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：符号や関数の混同",
                    detail: `
              加法定理は公式が似ているため、符号や$\\sin$と$\\cos$の組み合わせを間違えやすいです。
              語呂合わせ（例：「咲いたコスモス、コスモス咲いた」）などを活用して正確に覚えましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "$\\sin(75^\\circ)$ の値を求めなさい。（ヒント：$75^\\circ = 45^\\circ + 30^\\circ$）",
                        answer: "(sqrt(6)+sqrt(2))/4",
                        hint: "$\\sin(\\alpha + \\beta)$ の公式を使います。",
                    },
                    {
                        question:
                            "$\\cos(15^\\circ)$ の値を求めなさい。（ヒント：$15^\\circ = 45^\\circ - 30^\\circ$）",
                        answer: "(sqrt(6)+sqrt(2))/4",
                        hint: "$\\cos(\\alpha - \\beta)$ の公式を使います。",
                    },
                ],
            },
        ],
    },
    {
        topic: "指数関数と対数関数",
        steps: [
            {
                title: "指数関数",
                explanation: `
            指数関数は $y = a^x$ の形で表される関数です。$a$ は底と呼ばれ、$a>0, a \\neq 1$ です。
            指数法則（$a^m a^n = a^{m+n}$, $(a^m)^n = a^{mn}$ など）を使って計算します。
            グラフは、$a>1$ のとき増加関数、$0<a<1$ のとき減少関数となります。
          `,
                examples: [
                    {
                        title: "指数法則の例",
                        detail: "$2^3 \\times 2^4 = 2^{3+4} = 2^7 = 128$",
                    },
                    {
                        title: "グラフの例",
                        detail: "$y=2^x$ は増加関数、$y=(\\frac{1}{2})^x$ は減少関数です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：指数法則の適用ミス",
                    detail: `
              特に、$(a^m)^n = a^{mn}$ と $a^m a^n = a^{m+n}$ の使い分けを間違えやすいです。
              また、負の指数 ($a^{-n} = \\frac{1}{a^n}$) や分数指数 ($a^{\\frac{1}{n}} = \\sqrt[n]{a}$) の計算も重要です。
            `,
                },
                problems: [
                    {
                        question: "$2^3 \\times 2^4$ を計算しなさい。",
                        answer: "128",
                        hint: "指数法則 $a^m a^n = a^{m+n}$ を使いましょう。",
                    },
                    {
                        question: "$(3^2)^3$ を計算しなさい。",
                        answer: "729",
                        hint: "指数法則 $(a^m)^n = a^{mn}$ を使いましょう。",
                    },
                ],
            },
            {
                title: "対数関数",
                explanation: `
            対数関数は、指数関数の逆関数で、$y = \\log_a x$ と表されます。これは「$a$ を何乗したら $x$ になるか」という意味です。
            対数法則（$\\log_a MN = \\log_a M + \\log_a N$, $\\log_a M^k = k \\log_a M$ など）を使って計算します。
            底の変換公式も重要です。
          `,
                examples: [
                    {
                        title: "対数の定義の例",
                        detail: "$\\log_2 8 = 3$ は $2^3 = 8$ を意味します。",
                    },
                    {
                        title: "対数法則の例",
                        detail: "$\\log_{10} 2 + \\log_{10} 5 = \\log_{10} (2 \\times 5) = \\log_{10} 10 = 1$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：対数の定義と法則の混同",
                    detail: `
              対数の定義（例：$\\log_2 8 = 3$ は $2^3 = 8$ を意味する）をしっかり理解することが重要です。
              対数法則の適用も、足し算が掛け算に、引き算が割り算になるなど、指数法則と逆の関係にあることを意識しましょう。
            `,
                },
                problems: [
                    {
                        question: "$\\log_2 8$ の値を求めなさい。",
                        answer: "3",
                        hint: "2を何乗したら8になりますか？",
                    },
                    {
                        question:
                            "$\\log_{10} 2 + \\log_{10} 5$ を計算しなさい。",
                        answer: "1",
                        hint: "対数法則 $\\log_a M + \\log_a N = \\log_a MN$ を使いましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "微分法と積分法", // 数学IIの範囲での基本的な微分積分
        steps: [
            {
                title: "導関数 (基本的な多項式)",
                explanation: `
            数学IIで学ぶ微分法は、主に多項式関数の導関数を求めることです。
            基本的な微分公式 $(x^n)' = nx^{n-1}$ や定数、和・差の微分公式を使って計算します。
            導関数は、元の関数の各点での接線の傾きを表す関数です。
          `,
                examples: [
                    { title: "導関数の例", detail: "$(x^3)' = 3x^2$" },
                    {
                        title: "複数の項の微分例",
                        detail: "$(x^2 - 4x + 5)' = 2x - 4$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：定数項の微分",
                    detail: `
              定数項（例：$x^2+5$ の $5$）を微分すると $0$ になります。
              これを $1$ と間違えてしまうことが多いので注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = x^3 - 4x^2 + 2x - 1$ を微分しなさい。",
                        answer: "3x^2 - 8x + 2",
                        hint: "各項を個別に微分しましょう。",
                    },
                    {
                        question: "関数 $g(x) = 5x^2 + 3$ を微分しなさい。",
                        answer: "10x",
                        hint: "定数項の微分に注意しましょう。",
                    },
                ],
            },
            {
                title: "接線の方程式 (多項式)",
                explanation: `
            関数 $y=f(x)$ 上の点 $(a, f(a))$ における接線の方程式は、
            $y - f(a) = f'(a)(x - a)$ で与えられます。
            まず導関数 $f'(x)$ を求め、次に点 $a$ での微分係数 $f'(a)$ を計算し、最後に方程式の形にまとめます。
          `,
                examples: [
                    {
                        title: "接線の方程式の例",
                        detail: "$y = x^2$ の $x=1$ における接線。\n$f'(x) = 2x$ なので $f'(1) = 2$。\n点 $(1, f(1)) = (1, 1)$ を通るので、$y - 1 = 2(x - 1) \\Rightarrow y = 2x - 1$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：接線の傾きと方程式の混同",
                    detail: `
              $f'(a)$ は接線の「傾き」であり、方程式そのものではありません。
              方程式を求める際には、点 $(a, f(a))$ も利用して、直線の式を完成させる必要があります。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $y = x^2 + 2x$ の $x=1$ における接線の方程式を求めなさい。",
                        answer: "y=4x-1",
                        hint: "まず$f'(x)$と$f'(1)$を求め、点$(1, f(1))$を通る直線を考えましょう。",
                    },
                    {
                        question:
                            "関数 $y = x^3 - 3x$ の $x=0$ における接線の方程式を求めなさい。",
                        answer: "y=-3x",
                        hint: "同様に$f'(x)$と$f'(0)$を求め、点$(0, f(0))$を通る直線を考えましょう。",
                    },
                ],
            },
            {
                title: "不定積分 (基本的な多項式)",
                explanation: `
            数学IIで学ぶ積分法は、主に多項式関数の不定積分を求めることです。
            不定積分の基本公式 $\\int x^n dx = \\frac{1}{n+1}x^{n+1} + C$ を使って計算します。
            $C$ は積分定数で、必ずつけ忘れないようにしましょう。
          `,
                examples: [
                    {
                        title: "不定積分の例",
                        detail: "$\\int x^2 dx = \\frac{1}{3}x^3 + C$",
                    },
                    {
                        title: "複数の項の積分例",
                        detail: "$\\int (3x^2 + 2x) dx = x^3 + x^2 + C$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：積分定数Cの忘れ",
                    detail: `
              不定積分では、積分定数 $C$ をつけ忘れると不正解になります。
              これは、微分すると定数が消えてしまうため、元の関数にどのような定数があったか分からないからです。
            `,
                },
                problems: [
                    {
                        question: "$\\int (2x + 3) dx$ を求めなさい。",
                        answer: "x^2+3x+C",
                        hint: "各項を個別に積分し、積分定数Cをつけましょう。",
                    },
                    {
                        question: "$\\int (x^2 - 5x + 4) dx$ を求めなさい。",
                        answer: "1/3 x^3 - 5/2 x^2 + 4x + C",
                        hint: "それぞれの項の指数に1を足し、その数で割りましょう。",
                    },
                ],
            },
            {
                title: "定積分と面積 (多項式)",
                explanation: `
            定積分は、関数とx軸、または複数の曲線で囲まれた部分の面積を求めるのに使われます。
            $\\int_a^b f(x) dx = [F(x)]_a^b = F(b) - F(a)$ で計算します。
            面積を求める場合は、x軸より下の部分の積分値が負になるため、絶対値を取るか、符号を反転させる必要があります。
          `,
                examples: [
                    {
                        title: "定積分の例",
                        detail: "$\\int_0^1 x^2 dx = [\\frac{1}{3}x^3]_0^1 = \\frac{1}{3}(1)^3 - \\frac{1}{3}(0)^3 = \\frac{1}{3}$",
                    },
                    {
                        title: "面積の例",
                        detail: "曲線 $y = x^2 - 1$ と $x$軸で囲まれた部分の面積は、$\\int_{-1}^1 |x^2 - 1| dx = \\int_{-1}^1 -(x^2 - 1) dx = \\int_{-1}^1 (1 - x^2) dx = [x - \\frac{1}{3}x^3]_{-1}^1 = (1 - \\frac{1}{3}) - (-1 + \\frac{1}{3}) = \\frac{2}{3} - (-\\frac{2}{3}) = \\frac{4}{3}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：x軸より下の面積の符号",
                    detail: `
              面積は常に正の値です。関数がx軸の下にある区間では、定積分の値は負になります。
              この場合、その区間の定積分の値に絶対値をつけるか、$-f(x)$ を積分するようにしましょう。
            `,
                },
                problems: [
                    {
                        question: "$\\int_0^2 (x^2) dx$ を計算しなさい。",
                        answer: "8/3",
                        hint: "まず不定積分を求め、その後で上端と下端の値を代入して引き算します。",
                    },
                    {
                        question:
                            "曲線 $y = x^2 - 1$ と $x$軸で囲まれた部分の面積を求めなさい。",
                        answer: "4/3",
                        hint: "x軸との交点を求め、その区間で積分します。x軸より下の部分の符号に注意。",
                    },
                ],
            },
        ],
    },
];

// 数学B の学習コンテンツ
const mathBLessons: LearningTopic[] = [
    {
        topic: "数列",
        steps: [
            {
                title: "等差数列と等比数列",
                explanation: `
            等差数列は、隣り合う項の差が一定（公差）の数列です。一般項は $a_n = a_1 + (n-1)d$ です。
            等比数列は、隣り合う項の比が一定（公比）の数列です。一般項は $a_n = a_1 r^{n-1}$ です。
          `,
                examples: [
                    {
                        title: "等差数列の例",
                        detail: "数列：1, 3, 5, 7, ... は、公差 $d=2$ の等差数列です。第n項は $a_n = 1 + (n-1)2 = 2n-1$。",
                    },
                    {
                        title: "等比数列の例",
                        detail: "数列：2, 6, 18, 54, ... は、公比 $r=3$ の等比数列です。第n項は $a_n = 2 \\cdot 3^{n-1}$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：一般項の公式の混同",
                    detail: `
              等差数列と等比数列の一般項の公式を混同しないように注意しましょう。
              特に、等比数列の公比 $r$ の指数が $n-1$ であることを忘れないようにしましょう。
            `,
                },
                problems: [
                    {
                        question: "初項3、公差2の等差数列の第5項を求めなさい。",
                        answer: "11",
                        hint: "等差数列の一般項の公式に当てはめましょう。",
                    },
                    {
                        question: "初項2、公比3の等比数列の第4項を求めなさい。",
                        answer: "54",
                        hint: "等比数列の一般項の公式に当てはめましょう。",
                    },
                ],
            },
            {
                title: "数列の和 (Σ記号)",
                explanation: `
            数列の各項を足し合わせたものを数列の和と呼び、Σ（シグマ）記号を使って表します。
            等差数列の和の公式：$S_n = \\frac{n(a_1 + a_n)}{2}$ または $S_n = \\frac{n(2a_1 + (n-1)d)}{2}$
            等比数列の和の公式：$S_n = \\frac{a_1(r^n - 1)}{r-1}$ （$r \\neq 1$ のとき）
            Σ記号の計算では、公式や性質を正しく適用することが重要です。
          `,
                examples: [
                    {
                        title: "等差数列の和の例",
                        detail: "初項1、公差2の等差数列の初項から第5項までの和：$S_5 = \\frac{5(2 \\cdot 1 + (5-1)2)}{2} = \\frac{5(2+8)}{2} = 25$",
                    },
                    {
                        title: "Σ記号の例",
                        detail: "$\\sum_{k=1}^{3} k^2 = 1^2 + 2^2 + 3^2 = 1 + 4 + 9 = 14$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：Σ記号の範囲と変数",
                    detail: `
              Σ記号の上下に書かれている添字の範囲を正確に把握しましょう。
              また、Σ記号の右にある式が、どの変数（例：$k$）に依存しているかを確認し、それ以外の文字は定数として扱うことに注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "初項1、末項10、項数10の等差数列の和を求めなさい。",
                        answer: "55",
                        hint: "等差数列の和の公式を使いましょう。",
                    },
                    {
                        question: "$\\sum_{k=1}^{n} k$ の公式を答えなさい。",
                        answer: "n(n+1)/2",
                        hint: "自然数の和の公式です。",
                    },
                ],
            },
            {
                title: "漸化式",
                explanation: `
            漸化式は、数列の各項を、その前の項やいくつかの前の項を使って表す式です。
            例えば、等差数列は $a_{n+1} = a_n + d$、等比数列は $a_{n+1} = r a_n$ と表せます。
            漸化式を解くことで、数列の一般項を求めることができます。
          `,
                examples: [
                    {
                        title: "等差数列の漸化式と一般項",
                        detail: "$a_1 = 1, a_{n+1} = a_n + 2$ のとき、一般項は $a_n = 2n-1$ です。",
                    },
                    {
                        title: "等比数列の漸化式と一般項",
                        detail: "$a_1 = 3, a_{n+1} = 4a_n$ のとき、一般項は $a_n = 3 \\cdot 4^{n-1}$ です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：漸化式のタイプの見分け方",
                    detail: `
              漸化式にはいくつかの典型的なパターン（等差型、等比型、特性方程式を用いるものなど）があります。
              与えられた漸化式がどのタイプに当てはまるかを見分け、適切な解法を適用することが重要です。
            `,
                },
                problems: [
                    {
                        question:
                            "$a_1 = 1, a_{n+1} = a_n + 3$ で定義される数列の一般項 $a_n$ を求めなさい。",
                        answer: "3n-2",
                        hint: "これは等差数列の漸化式です。",
                    },
                    {
                        question:
                            "$a_1 = 2, a_{n+1} = 2a_n$ で定義される数列の一般項 $a_n$ を求めなさい。",
                        answer: "2^n",
                        hint: "これは等比数列の漸化式です。",
                    },
                ],
            },
        ],
    },
    {
        topic: "ベクトル",
        steps: [
            {
                title: "ベクトルの演算",
                explanation: `
            ベクトルは、向きと大きさを持つ量です。
            ベクトルの足し算は、平行四辺形の法則や三角形の法則で表せます。
            実数倍は、ベクトルの大きさを変えたり、向きを反転させたりします。
            成分表示されたベクトルは、各成分ごとに足し算や実数倍の計算を行います。
          `,
                examples: [
                    {
                        title: "ベクトルの足し算の例",
                        detail: "$\\vec{a} = (1, 2)$, $\\vec{b} = (3, 1)$ のとき、$\\vec{a} + \\vec{b} = (1+3, 2+1) = (4, 3)$",
                    },
                    {
                        title: "実数倍の例",
                        detail: "$\\vec{a} = (2, -1)$ のとき、$2\\vec{a} = (2 \\times 2, 2 \\times (-1)) = (4, -2)$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：ベクトルの足し算と引き算の向き",
                    detail: `
              ベクトル $\\vec{a} + \\vec{b}$ は、$\\vec{a}$ の終点から $\\vec{b}$ を始める形です。
              ベクトル $\\vec{a} - \\vec{b}$ は、$\\vec{b}$ の始点から $\\vec{a}$ の始点へ向かうベクトルと等しいです。
              図で確認しながら、向きを間違えないようにしましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "$\\vec{a} = (2, 1)$, $\\vec{b} = (3, -2)$ のとき、$\\vec{a} + \\vec{b}$ を求めなさい。",
                        answer: "(5,-1)",
                        hint: "各成分を足し合わせましょう。",
                    },
                    {
                        question:
                            "$\\vec{a} = (1, 4)$ のとき、$3\\vec{a}$ を求めなさい。",
                        answer: "(3,12)",
                        hint: "各成分を3倍しましょう。",
                    },
                ],
            },
            {
                title: "平面ベクトル",
                explanation: `
            平面ベクトルは、2次元の座標平面上で考えられるベクトルです。
            内積は、2つのベクトルのなす角や垂直条件を調べるのに使われます。
            $\\vec{a} \\cdot \\vec{b} = |\\vec{a}||\\vec{b}|\\cos \\theta$ または 成分で $\\vec{a} \\cdot \\vec{b} = a_x b_x + a_y b_y$ です。
            内積が0ならば、2つのベクトルは垂直です。
          `,
                examples: [
                    {
                        title: "内積の計算例",
                        detail: "$\\vec{a} = (1, 2)$, $\\vec{b} = (3, -1)$ のとき、$\\vec{a} \\cdot \\vec{b} = 1 \\times 3 + 2 \\times (-1) = 3 - 2 = 1$",
                    },
                    {
                        title: "垂直条件の例",
                        detail: "$\\vec{a} = (2, 1)$, $\\vec{b} = (-1, 2)$ のとき、$\\vec{a} \\cdot \\vec{b} = 2(-1) + 1(2) = -2 + 2 = 0$ なので、$\\vec{a}$ と $\\vec{b}$ は垂直です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：内積とベクトルの積",
                    detail: `
              内積はスカラー（数値）になる演算であり、ベクトルになるわけではありません。
              ベクトルの積には、内積の他に外積（高校数学では扱わない）がありますが、混同しないようにしましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "$\\vec{a} = (1, 2)$, $\\vec{b} = (3, -1)$ のとき、内積 $\\vec{a} \\cdot \\vec{b}$ を求めなさい。",
                        answer: "1",
                        hint: "成分同士を掛けて足し合わせましょう。",
                    },
                    {
                        question:
                            "2つのベクトル $\\vec{a} = (2, k)$, $\\vec{b} = (3, 6)$ が垂直であるとき、定数kの値を求めなさい。",
                        answer: "k=-1",
                        hint: "内積が0になる条件を使いましょう。",
                    },
                ],
            },
            {
                title: "空間ベクトル",
                explanation: `
            空間ベクトルは、3次元の空間で考えられるベクトルです。
            平面ベクトルと同様に、足し算、実数倍、内積などの演算が可能です。
            成分表示は $(x, y, z)$ のように3つの成分を持ちます。
            空間座標における点や直線の位置関係をベクトルで表現できます。
          `,
                examples: [
                    {
                        title: "空間ベクトルの足し算の例",
                        detail: "$\\vec{a} = (1, 2, 3)$, $\\vec{b} = (4, -1, 0)$ のとき、$\\vec{a} + \\vec{b} = (1+4, 2-1, 3+0) = (5, 1, 3)$",
                    },
                    {
                        title: "空間ベクトルの大きさの例",
                        detail: "$\\vec{a} = (1, -2, 2)$ のとき、大きさ $|\\vec{a}| = \\sqrt{1^2 + (-2)^2 + 2^2} = \\sqrt{1+4+4} = \\sqrt{9} = 3$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：空間のイメージ不足",
                    detail: `
              空間ベクトルを扱う際には、3次元空間での位置関係や方向を正確にイメージすることが重要です。
              特に、図形的な問題を解く際には、座標軸を意識した図を描く練習をしましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "点A$(1,2,3)$ と点B$(4,0,1)$ のとき、ベクトル $\\vec{AB}$ の成分を求めなさい。",
                        answer: "(3,-2,-2)",
                        hint: "終点の成分から始点の成分を引きましょう。",
                    },
                    {
                        question:
                            "ベクトル $\\vec{a} = (1, -1, 2)$ の大きさを求めなさい。",
                        answer: "sqrt(6)",
                        hint: "各成分の二乗の和の平方根です。",
                    },
                ],
            },
        ],
    },
];

// 数学III の学習コンテンツ (既存の微分積分コンテンツを再利用・一部追加)
const math3Lessons: LearningTopic[] = [
    {
        topic: "複素数平面",
        steps: [
            {
                title: "複素数と複素数平面",
                explanation: `
            複素数は $a+bi$ の形で表される数で、実数 $a$ と虚数 $bi$ の和です。
            複素数平面（ガウス平面）は、横軸を実軸、縦軸を虚軸として複素数を点で表した平面です。
            複素数の加減算は、複素数平面上ではベクトルの合成のように考えることができます。
          `,
                examples: [
                    {
                        title: "複素数の加算例",
                        detail: "$(2+3i) + (1-i) = (2+1) + (3-1)i = 3+2i$",
                    },
                    {
                        title: "複素数平面での表示",
                        detail: "複素数 $2+i$ は、複素数平面上で点 $(2,1)$ に対応します。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：虚数と複素数の混同",
                    detail: `
              虚数単位 $i$ を含む数を虚数と呼びますが、複素数 $a+bi$ のうち $b \\neq 0$ のものが虚数です。
              $a=0$ の場合は純虚数と呼びます。
              複素数平面上での点の位置と、その複素数の実部・虚部の対応を正確に理解しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "複素数 $3+4i$ を複素数平面上に図示しなさい。",
                        answer: "実軸3, 虚軸4の点",
                        hint: "実部がx座標、虚部がy座標に対応します。",
                    },
                    {
                        question:
                            "複素数 $z = 1 + \\sqrt{3}i$ の絶対値 $|z|$ を求めなさい。",
                        answer: "2",
                        hint: "原点からの距離です。三平方の定理を使いましょう。",
                    },
                ],
            },
            {
                title: "ド・モアブルの定理",
                explanation: `
            複素数を極形式 $z = r(\\cos \\theta + i \\sin \\theta)$ で表すと、
            $z^n = r^n (\\cos n\\theta + i \\sin n\\theta)$ という関係が成り立ちます。これがド・モアブルの定理です。
            この定理を使うと、複素数の累乗や、複素数の方程式の解を簡単に求めることができます。
          `,
                examples: [
                    {
                        title: "ド・モアブルの定理の適用例",
                        detail: "$z = \\cos(\\frac{\\pi}{3}) + i \\sin(\\frac{\\pi}{3})$ のとき、$z^2 = \\cos(\\frac{2\\pi}{3}) + i \\sin(\\frac{2\\pi}{3})$",
                    },
                    {
                        title: "累乗の計算例",
                        detail: "$(1+i)^2$ を極形式で考えると、$1+i = \\sqrt{2}(\\cos(\\frac{\\pi}{4}) + i \\sin(\\frac{\\pi}{4}))$。よって $(1+i)^2 = (\\sqrt{2})^2 (\\cos(\\frac{2\\pi}{4}) + i \\sin(\\frac{2\\pi}{4})) = 2(\\cos(\\frac{\\pi}{2}) + i \\sin(\\frac{\\pi}{2})) = 2(0+i) = 2i$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：角度の計算ミス",
                    detail: `
              ド・モアブルの定理を適用する際、角度 $\\theta$ を $n$ 倍することになります。
              このとき、角度が $2\\pi$（または $360^\\circ$）を超える場合は、その周期性を考慮して角度を調整しましょう。
              また、極形式への変換を正確に行うことが前提となります。
            `,
                },
                problems: [
                    {
                        question:
                            "$(\\cos \\theta + i \\sin \\theta)^3$ を計算しなさい。",
                        answer: "cos(3θ)+isin(3θ)",
                        hint: "ド・モアブルの定理をそのまま適用しましょう。",
                    },
                    {
                        question: "$(1+i)^4$ を計算しなさい。",
                        answer: "-4",
                        hint: "まず $1+i$ を極形式に直し、その後ド・モアブルの定理を適用しましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "関数",
        steps: [
            {
                title: "いろいろな関数 (分数関数、無理関数など)",
                explanation: `
            数学IIIでは、分数関数 ($y = \\frac{P(x)}{Q(x)}$)、無理関数 ($y = \\sqrt{f(x)}$)、指数関数、対数関数、三角関数など、様々な種類の関数を学びます。
            それぞれの関数の定義域、値域、グラフの概形、漸近線などを理解することが重要です。
          `,
                examples: [
                    {
                        title: "分数関数の例",
                        detail: "$y = \\frac{1}{x}$ の定義域は $x \\neq 0$、漸近線は $x=0, y=0$ です。",
                    },
                    {
                        title: "無理関数の例",
                        detail: "$y = \\sqrt{x}$ の定義域は $x \\ge 0$、値域は $y \\ge 0$ です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：定義域の確認不足",
                    detail: `
              分数関数では分母が0になる点、無理関数では根号の中が負になる点など、関数が定義されない範囲があります。
              これらの定義域を正確に把握しないと、グラフを描いたり、極限や微分を計算する際に間違いが生じます。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $y = \\frac{1}{x-2}$ の漸近線を求めなさい。",
                        answer: "x=2, y=0",
                        hint: "分母が0になる点と、xが無限大に近づくときのyの値を考えましょう。",
                    },
                    {
                        question:
                            "関数 $y = \\sqrt{x+1}$ の定義域を求めなさい。",
                        answer: "x>=-1",
                        hint: "根号の中は負にならないという条件を考えましょう。",
                    },
                ],
            },
            {
                title: "逆関数と合成関数",
                explanation: `
            逆関数は、元の関数のxとyの役割を入れ替えた関数です。$y=f(x)$ の逆関数は $x=f(y)$ をyについて解いたものです。記号では $f^{-1}(x)$ と書きます。
            合成関数は、ある関数の結果を別の関数の入力として使う関数です。$f(g(x))$ や $g(f(x))$ のように表されます。
          `,
                examples: [
                    {
                        title: "逆関数の例",
                        detail: "$y = x+1$ の逆関数は、$x = y+1 \\Rightarrow y = x-1$ です。",
                    },
                    {
                        title: "合成関数の例",
                        detail: "$f(x) = x^2$, $g(x) = x+1$ のとき、$f(g(x)) = f(x+1) = (x+1)^2 = x^2+2x+1$ です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：逆関数の存在条件",
                    detail: `
              逆関数が存在するのは、元の関数が1対1の対応である（単調増加または単調減少）場合のみです。
              例えば、$y=x^2$ は逆関数を持ちません（定義域を制限すれば持つ）。
              合成関数の順序も重要で、$f(g(x))$ と $g(f(x))$ は一般に異なります。
            `,
                },
                problems: [
                    {
                        question: "関数 $y = 2x - 1$ の逆関数を求めなさい。",
                        answer: "y=1/2x+1/2",
                        hint: "xとyを入れ替えてyについて解きましょう。",
                    },
                    {
                        question:
                            "関数 $f(x) = x+1$, $g(x) = x^2$ のとき、$f(g(x))$ を求めなさい。",
                        answer: "x^2+1",
                        hint: "$g(x)$ を $f(x)$ のxに代入しましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "極限", // トピック名
        steps: [
            {
                title: "極限の概念と表記", // ステップのタイトル
                explanation: `
            極限とは、関数がある値に限りなく近づくときの関数の値の振る舞いを表すものです。例えば、$x$が2に近づくとき、$x+1$は3に近づきます。これを$\\lim_{x \\to 2} (x+1) = 3$と表記します。
            「限りなく近づく」というのは、その値そのものになるわけではない、という点が重要です。
          `,
                examples: [
                    {
                        title: "極限の例",
                        detail: "関数 $f(x) = x+1$ において、xが2に限りなく近づくとき、f(x)は3に限りなく近づきます。$\\lim_{x \\to 2} (x+1) = 3$",
                    },
                ],
                pitfall: {
                    // よくある間違いのセクション
                    title: "よくある間違い：極限と代入を混同する",
                    detail: `
              極限は「限りなく近づく」ことであり、その値を「代入する」こととは異なります。
              例えば、$\\lim_{x \\to 0} \\frac{x^2}{x}$ の場合、単純に$x=0$を代入すると$\\frac{0}{0}$となり計算できません。
              しかし、この式は$x \\neq 0$のとき$\\frac{x^2}{x} = x$と簡略化できるため、$\\lim_{x \\to 0} x = 0$となります。
              これは、$x$が0に限りなく近づくとき、関数$\\frac{x^2}{x}$の値は0に限りなく近づく、という意味です。
            `,
                },
                problems: [
                    // 練習問題
                    {
                        question:
                            "$\\lim_{x \\to 3} (2x - 1)$ の値を求めなさい。",
                        answer: "5",
                        hint: "関数に$x$の値を代入してみてください。",
                    },
                    {
                        question:
                            "$\\lim_{x \\to 1} (x^2 + 4)$ の値を求めなさい。",
                        answer: "5",
                        hint: "これも単純な代入で解けます。",
                    },
                ],
            },
            {
                title: "極限の計算（多項式関数）",
                explanation: `
            多項式関数の極限は、基本的に$x$が近づく値を関数に代入することで求められます。
            例えば、$\\lim_{x \\to a} P(x) = P(a)$ となります。
          `,
                examples: [
                    {
                        title: "有限値への極限",
                        detail: "$\\lim_{x \\to 2} (x^2 + 3x - 1) = 2^2 + 3(2) - 1 = 4 + 6 - 1 = 9$",
                    },
                    {
                        title: "無限大への極限",
                        detail: "$\\lim_{x \\to \\infty} (x^3 - 2x) = \\infty$ （最高次の項 $x^3$ の振る舞いを考える）",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：無限大の扱い",
                    detail: `
              $x \\to \\infty$ (無限大) の極限を考える場合、単純な代入はできません。
              例えば、$\\lim_{x \\to \\infty} (x^2 - x)$ の場合、$x^2$の方が$x$よりも速く増加するため、結果は$\\infty$となります。
              最高次の項に注目するのがポイントです。
            `,
                },
                problems: [
                    {
                        question:
                            "$\\lim_{x \\to -2} (x^3 + 3x - 5)$ の値を求めなさい。",
                        answer: "-19",
                        hint: "多項式関数なので、直接代入して計算できます。",
                    },
                    {
                        question:
                            "$\\lim_{x \\to \\infty} (x^2 - 5x + 1)$ の値を求めなさい。",
                        answer: "∞", // 無限大は文字列として扱う
                        hint: "最高次の項の振る舞いを考えると良いでしょう。",
                    },
                ],
            },
            {
                title: "極限の計算（分数関数）",
                explanation: `
            分数関数の極限では、分母が0になる場合に注意が必要です。
            分母が0になる場合、因数分解や有理化などの操作で式を簡略化してから極限を計算します。
          `,
                examples: [
                    {
                        title: "約分による例",
                        detail: "$\\lim_{x \\to 1} \\frac{x^2 - 1}{x - 1} = \\lim_{x \\to 1} \\frac{(x-1)(x+1)}{x-1} = \\lim_{x \\to 1} (x+1) = 1+1 = 2$",
                    },
                    {
                        title: "有理化による例",
                        detail: "$\\lim_{x \\to 0} \\frac{\\sqrt{x+1} - 1}{x} = \\lim_{x \\to 0} \\frac{(\\sqrt{x+1} - 1)(\\sqrt{x+1} + 1)}{x(\\sqrt{x+1} + 1)} = \\lim_{x \\to 0} \\frac{x+1 - 1}{x(\\sqrt{x+1} + 1)} = \\lim_{x \\to 0} \\frac{x}{x(\\sqrt{x+1} + 1)} = \\lim_{x \\to 0} \\frac{1}{\\sqrt{x+1} + 1} = \\frac{1}{1+1} = \\frac{1}{2}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：約分せずに代入する",
                    detail: `
              $\\lim_{x \\to 2} \\frac{x^2 - 4}{x - 2}$ のような問題で、約分せずに$x=2$を代入すると$\\frac{0}{0}$となり、計算できません。
              この場合、分子を因数分解して$\\frac{(x-2)(x+2)}{x-2}$とし、$x \\neq 2$のときに約分すると$x+2$になります。
              したがって、$\\lim_{x \\to 2} (x+2) = 4$となります。
            `,
                },
                problems: [
                    {
                        question:
                            "$\\lim_{x \\to 1} \\frac{x^2 - 1}{x - 1}$ の値を求めなさい。",
                        answer: "2",
                        hint: "分子を因数分解して約分できます。",
                    },
                    {
                        question:
                            "$\\lim_{x \\to 0} \\frac{\\sqrt{x+1} - 1}{x}$ の値を求めなさい。（ヒント：有理化）",
                        answer: "0.5",
                        hint: "分母の有理化を試みてください。",
                    },
                ],
            },
            {
                title: "関数の連続性",
                explanation: `
            関数$f(x)$が$x=a$で連続であるとは、以下の3つの条件が満たされることです。
            1. $f(a)$が存在する。
            2. $\\lim_{x \\to a} f(x)$が存在する。
            3. $\\lim_{x \\to a} f(x) = f(a)$ である。
            簡単に言えば、グラフが途切れていない状態です。
          `,
                examples: [
                    {
                        title: "連続な関数の例",
                        detail: "多項式関数 $f(x) = x^2+1$ は全ての点で連続です。",
                    },
                    {
                        title: "不連続な関数の例",
                        detail: "関数 $f(x) = \\frac{1}{x}$ は $x=0$ で定義されないため不連続です。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：グラフが途切れていれば不連続",
                    detail: `
              連続性の定義は3つの条件全てを満たす必要があります。
              例えば、関数が$x=a$で定義されていても、その点での極限値が存在しない場合や、極限値と関数値が一致しない場合は不連続です。
              穴が開いているグラフや、ジャンプしているグラフは不連続です。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = \\begin{cases} x+2 & (x \\neq 1) \\\\ 5 & (x = 1) \\end{cases}$ は $x=1$ で連続ですか？",
                        answer: "不連続",
                        hint: "xが1に近づくときの極限値と、x=1での関数値が一致するか確認しましょう。",
                    },
                    {
                        question:
                            "関数 $g(x) = x^2 - 3x + 2$ は全ての点で連続ですか？",
                        answer: "連続",
                        hint: "多項式関数は常に連続であることを思い出してください。",
                    },
                ],
            },
        ],
    },
    {
        topic: "微分", // トピック名
        steps: [
            {
                title: "微分の定義と導関数",
                explanation: `
            微分とは、関数の変化の割合、つまり「傾き」を求めることです。
            特に、ある点における接線の傾きを求める操作です。
            関数$f(x)$の$x=a$における微分係数は、$\\lim_{h \\to 0} \\frac{f(a+h) - f(a)}{h}$ で定義されます。
            そして、この微分係数を$x$の関数として一般化したものが「導関数」で、$f'(x)$と書きます。
          `,
                examples: [
                    {
                        title: "微分の定義の例",
                        detail: "$f(x) = x^2$ の導関数：\n$\\lim_{h \\to 0} \\frac{(x+h)^2 - x^2}{h} = \\lim_{h \\to 0} \\frac{x^2 + 2xh + h^2 - x^2}{h} = \\lim_{h \\to 0} \\frac{2xh + h^2}{h} = \\lim_{h \\to 0} (2x + h) = 2x$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：微分係数と導関数の違い",
                    detail: `
              微分係数は「特定の点における接線の傾き」という「値」です。
              導関数は「任意の点における接線の傾きを表す関数」であり、「式」です。
              混同しないように注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = x^2$ の導関数を定義に基づいて求めなさい。",
                        answer: "2x",
                        hint: "微分の定義式に当てはめて計算してみましょう。",
                    },
                    {
                        question:
                            "関数 $f(x) = 3x + 1$ の導関数を定義に基づいて求めなさい。",
                        answer: "3",
                        hint: "微分の定義式を使います。直線の傾きを考えても良いでしょう。",
                    },
                ],
            },
            {
                title: "基本的な微分公式",
                explanation: `
            毎回定義を使って微分するのは大変なので、便利な公式があります。
            1. $C$ (定数) の微分: $(C)' = 0$
            2. $x^n$ の微分: $(x^n)' = nx^{n-1}$
            3. 定数倍の微分: $(Cf(x))' = C(f(x))'$
            4. 和・差の微分: $(f(x) \\pm g(x))' = f'(x) \\pm g'(x)$
            これらの公式を組み合わせることで、多くの関数を微分できます。
          `,
                examples: [
                    { title: "微分公式の例", detail: "$(x^4)' = 4x^3$" },
                    {
                        title: "複数の項の微分例",
                        detail: "$(5x^3 - 2x^2 + 7)' = 15x^2 - 4x$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：定数の微分を1にしてしまう",
                    detail: `
              定数（数字のみの項）の微分は常に0です。
              例えば、$(x^2 + 5)' = (x^2)' + (5)' = 2x + 0 = 2x$ となります。
              $5$を$1$にしてしまう間違いが多いので注意しましょう。
            `,
                },
                problems: [
                    {
                        question: "関数 $f(x) = 4x^3$ を微分しなさい。",
                        answer: "12x^2",
                        hint: "定数倍の公式と$x^n$の微分公式を使います。",
                    },
                    {
                        question:
                            "関数 $g(x) = x^5 - 2x^2 + 7$ を微分しなさい。",
                        answer: "5x^4 - 4x",
                        hint: "それぞれの項を個別に微分し、和・差の公式を適用しましょう。定数の微分に注意。",
                    },
                ],
            },
            {
                title: "接線の傾き",
                explanation: `
            関数$y=f(x)$上の点$(a, f(a))$における接線の傾きは、その点での導関数の値、$f'(a)$で与えられます。
            つまり、導関数を求めてから$x=a$を代入すれば、接線の傾きがわかります。
          `,
                examples: [
                    {
                        title: "接線の傾きの例",
                        detail: "$f(x) = x^3$ の $x=2$ における接線の傾き。\n$f'(x) = 3x^2$ なので、$f'(2) = 3(2^2) = 12$。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：接線の傾きと接線の方程式を混同する",
                    detail: `
              接線の傾きは単なる「数値」ですが、接線の方程式は「$y = mx + b$」のような「式」です。
              接線の方程式を求めるには、傾き$m=f'(a)$と点$(a, f(a))$を使って、$y - f(a) = f'(a)(x - a)$ の公式を使います。
              問題が「傾き」を求めているのか、「方程式」を求めているのか、よく確認しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = x^2 + 3x$ の $x=1$ における接線の傾きを求めなさい。",
                        answer: "5",
                        hint: "まず$f'(x)$を求め、その後に$x=1$を代入しましょう。",
                    },
                    {
                        question:
                            "関数 $g(x) = 2x^3 - 4$ の $x=-1$ における接線の傾きを求めなさい。",
                        answer: "6",
                        hint: "同様に$g'(x)$を求めてから$x=-1$を代入します。",
                    },
                ],
            },
            {
                title: "積の微分・商の微分",
                explanation: `
            関数の積や商を微分するための公式です。
            積の微分公式: $(f(x)g(x))' = f'(x)g(x) + f(x)g'(x)$
            商の微分公式: $\\left(\\frac{f(x)}{g(x)}\\right)' = \\frac{f'(x)g(x) - f(x)g'(x)}{(g(x))^2}$
            これらの公式は少し複雑ですが、慣れると非常に便利です。
          `,
                examples: [
                    {
                        title: "積の微分の例",
                        detail: "$((x^2+1)(x-2))' = (2x)(x-2) + (x^2+1)(1) = 2x^2 - 4x + x^2 + 1 = 3x^2 - 4x + 1$",
                    },
                    {
                        title: "商の微分の例",
                        detail: "$\\left(\\frac{x}{x+1}\\right)' = \\frac{(1)(x+1) - (x)(1)}{(x+1)^2} = \\frac{x+1 - x}{(x+1)^2} = \\frac{1}{(x+1)^2}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：積の微分で単純にそれぞれを微分してしまう",
                    detail: `
              $(f(x)g(x))' = f'(x)g'(x)$ と考えてしまう間違いが多いです。これは誤りです。
              積の微分公式では、片方を微分し、もう片方はそのまま、という組み合わせを足し合わせます。
              商の微分公式では、分子と分母の役割を間違えたり、分母を二乗し忘れたりすることに注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = (x^2+1)(3x-2)$ を微分しなさい。",
                        answer: "9x^2 - 4x + 3",
                        hint: "積の微分公式 $(fg)' = f'g + fg'$ を使います。",
                    },
                    {
                        question:
                            "関数 $g(x) = \\frac{x}{x+1}$ を微分しなさい。",
                        answer: "1/(x+1)^2",
                        hint: "商の微分公式 $\\left(\\frac{f}{g}\\right)' = \\frac{f'g - fg'}{g^2}$ を使います。",
                    },
                ],
            },
            {
                title: "合成関数の微分",
                explanation: `
            関数の中に別の関数が入っている形（合成関数）を微分する公式です。
            $(f(g(x)))' = f'(g(x)) \\cdot g'(x)$
            つまり、「外側の関数を微分したもの」に「内側の関数を微分したもの」を掛け合わせます。
          `,
                examples: [
                    {
                        title: "合成関数の微分の例",
                        detail: "$((2x+3)^4)' = 4(2x+3)^3 \\cdot (2x+3)' = 4(2x+3)^3 \\cdot 2 = 8(2x+3)^3$",
                    },
                    {
                        title: "別の例",
                        detail: "$(\\sin(x^2))' = \\cos(x^2) \\cdot (x^2)' = 2x \\cos(x^2)$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：内側の関数の微分を掛け忘れる",
                    detail: `
              $(f(g(x)))'$ を $f'(g(x))$ だけで終わらせてしまう間違いが多いです。
              例えば、$( (2x+1)^3 )'$ の場合、外側の関数は$(\\quad)^3$、内側の関数は$2x+1$です。
              正しくは $3(2x+1)^2 \\cdot (2x+1)' = 3(2x+1)^2 \\cdot 2 = 6(2x+1)^2$ となります。
              内側の関数の微分を掛け忘れないように注意しましょう。
            `,
                },
                problems: [
                    {
                        question: "関数 $f(x) = (3x-2)^4$ を微分しなさい。",
                        answer: "12(3x-2)^3",
                        hint: "外側の微分と内側の微分を掛け合わせる合成関数の微分公式を使います。",
                    },
                    {
                        question:
                            "関数 $g(x) = \\sqrt{x^2+1}$ を微分しなさい。",
                        answer: "x/sqrt(x^2+1)",
                        hint: "$\\sqrt{u}$ の微分は $\\frac{1}{2\\sqrt{u}}$ で、これに内側の関数 $x^2+1$ の微分を掛けます。",
                    },
                ],
            },
            {
                title: "高次導関数",
                explanation: `
            導関数をさらに微分することで、第二導関数、第三導関数などを求めることができます。
            $f(x)$ の導関数を $f'(x)$、第二導関数を $f''(x)$、$f'''(x)$、一般に $f^{(n)}(x)$ と表記します。
            これらの導関数は、関数の増減や凹凸、変曲点などを調べるのに役立ちます。
          `,
                examples: [
                    {
                        title: "高次導関数の例",
                        detail: "$f(x) = x^4$\n$f'(x) = 4x^3$\n$f''(x) = 12x^2$\n$f'''(x) = 24x$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：計算ミスを繰り返す",
                    detail: `
              高次導関数を求める際は、前の導関数の計算ミスが次の導関数に影響します。
              一つ一つの微分の計算を丁寧に、正確に行うことが重要ですし、
              特に符号や指数に注意しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = x^4 - 3x^2 + 5$ の第二導関数 $f''(x)$ を求めなさい。",
                        answer: "12x^2 - 6",
                        hint: "一度微分して$f'(x)$を求め、さらにもう一度微分して$f''(x)$を求めます。",
                    },
                    {
                        question:
                            "関数 $g(x) = \\sin(2x)$ の第二導関数 $g''(x)$ を求めなさい。",
                        answer: "-4sin(2x)",
                        hint: "合成関数の微分も考慮しながら、2回微分してみましょう。",
                    },
                ],
            },
            {
                title: "増減・凹凸とグラフ",
                explanation: `
            導関数 $f'(x)$ の符号は関数の増減を示します。$f'(x) > 0$ なら増加、$f'(x) < 0$ なら減少です。
            第二導関数 $f''(x)$ の符号は関数の凹凸を示します。$f''(x) > 0$ なら下に凸、$f''(x) < 0$ なら上に凸です。
            $f''(x)=0$ となる点で凹凸が変化する場合、その点を変曲点と呼びます。
            これらの情報を使って、関数のグラフの概形を描くことができます。
          `,
                examples: [
                    {
                        title: "増減の例",
                        detail: "$f(x) = x^3 - 3x$ のとき、$f'(x) = 3x^2 - 3 = 3(x-1)(x+1)$。\n$x < -1$ で $f'(x)>0$ (増加)、$-1 < x < 1$ で $f'(x)<0$ (減少)、$x > 1$ で $f'(x)>0$ (増加)。",
                    },
                    {
                        title: "凹凸の例",
                        detail: "$f(x) = x^3 - 3x$ のとき、$f''(x) = 6x$。\n$x < 0$ で $f''(x)<0$ (上に凸)、$x > 0$ で $f''(x)>0$ (下に凸)。$x=0$ で変曲点。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：増減と凹凸の混同",
                    detail: `
              $f'(x)$ は傾き（増加/減少）に関する情報、$f''(x)$ は曲がり具合（凹凸）に関する情報です。
              これらを混同すると、グラフの概形を間違えてしまいます。
              それぞれの導関数が何を表しているのかをしっかりと理解しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = x^3 - 3x$ の増減を調べ、極値を求めなさい。",
                        answer: "x=-1で極大値2, x=1で極小値-2",
                        hint: "$f'(x)$ を計算し、その符号の変化を調べましょう。",
                    },
                    {
                        question:
                            "関数 $f(x) = x^4 - 4x^3$ の凹凸を調べ、変曲点があればその座標を求めなさい。",
                        answer: "x=0で変曲点(0,0), x=2で変曲点(2,-16)",
                        hint: "$f''(x)$ を計算し、その符号の変化を調べましょう。",
                    },
                ],
            },
            {
                title: "最大・最小",
                explanation: `
            関数の最大値や最小値を求めるには、極値と定義域の端点での関数の値を比較します。
            閉区間 $[a, b]$ での最大値・最小値を求める手順は以下の通りです。
            1. $f'(x)=0$ となる$x$の値を求め、極値を計算する。
            2. 定義域の端点 $f(a)$、$f(b)$ の値を計算する。
            3. これらの値の中で最も大きいものが最大値、最も小さいものが最小値です。
          `,
                examples: [
                    {
                        title: "最大・最小の例",
                        detail: "$f(x) = x^2$ の閉区間 $[-2, 1]$ における最大・最小。\n$f'(x)=2x=0 \\Rightarrow x=0$ (極小値 $f(0)=0$)\n端点：$f(-2)=4, f(1)=1$。\nよって、最大値は4 ($x=-2$)、最小値は0 ($x=0$)。",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：端点の値を考慮し忘れる",
                    detail: `
              極値だけを調べて、定義域の端点での関数の値を考慮し忘れる間違いが多いです。
              特に、定義域が閉区間である場合、最大値や最小値は極値ではなく端点でとることがあります。
              必ず、極値と端点の両方を比較するようにしましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "関数 $f(x) = x^3 - 3x^2 + 2$ の閉区間 $[-1, 3]$ における最大値と最小値を求めなさい。",
                        answer: "最大値: 2 (x=0, x=3), 最小値: -2 (x=2)",
                        hint: "$f'(x)=0$となる点と、定義域の端点での関数値をすべて計算し、比較しましょう。",
                    },
                    {
                        question:
                            "関数 $g(x) = x + \\frac{4}{x}$ の $x>0$ における最小値を求めなさい。",
                        answer: "4",
                        hint: "相加平均・相乗平均の関係を使うか、$g'(x)$ を調べて増減表を書きましょう。",
                    },
                ],
            },
        ],
    },
    {
        topic: "積分", // トピック名
        steps: [
            {
                title: "不定積分の概念と基本公式",
                explanation: `
            積分は微分の逆の操作です。ある関数を微分すると元の関数になるような関数を求めることを「積分」と呼びます。
            $f(x)$ の不定積分は $\\int f(x) dx$ と表記され、$F'(x) = f(x)$ となる $F(x)$ を $f(x)$ の原始関数と呼びます。
            不定積分の基本公式: $\\int x^n dx = \\frac{1}{n+1}x^{n+1} + C$ （ただし、$n \\neq -1$）
            $C$ は積分定数と呼ばれ、任意の定数です。
          `,
                examples: [
                    {
                        title: "不定積分の例",
                        detail: "$\\int x^3 dx = \\frac{1}{4}x^4 + C$",
                    },
                    {
                        title: "複数の項の積分例",
                        detail: "$\\int (2x^2 - 3x + 1) dx = \\frac{2}{3}x^3 - \\frac{3}{2}x^2 + x + C$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：積分定数Cを忘れる",
                    detail: `
              不定積分では、必ず積分定数 $C$ を加える必要があります。
              なぜなら、定数を微分すると0になるため、元の関数がどのような定数を含んでいたか分からないからです。
              例えば、$(x^2)' = 2x$ ですが、$(x^2+5)' = 2x$ でもあります。
              したがって、$\\int 2x dx = x^2 + C$ となります。
            `,
                },
                problems: [
                    {
                        question: "$\\int (3x^2 - 2x + 1) dx$ を求めなさい。",
                        answer: "x^3 - x^2 + x + C",
                        hint: "各項を個別に積分し、最後に積分定数Cをつけましょう。",
                    },
                    {
                        question:
                            "$\\int (\\sqrt{x} + \\frac{1}{x^2}) dx$ を求めなさい。",
                        answer: "2/3 x^(3/2) - 1/x + C",
                        hint: "$\\sqrt{x} = x^{\\frac{1}{2}}$、$\\frac{1}{x^2} = x^{-2}$ と指数表記に直してから積分公式を使いましょう。",
                    },
                ],
            },
            {
                title: "置換積分法",
                explanation: `
            複雑な形の積分を、変数変換によって簡単な形に変換してから積分する方法です。
            例えば、$\\int f(g(x))g'(x) dx$ のような形の場合、$u = g(x)$ と置くと $du = g'(x) dx$ となり、
            $\\int f(u) du$ の形に変換できます。
          `,
                examples: [
                    {
                        title: "置換積分の例",
                        detail: "$\\int 2x(x^2+1)^3 dx$ のとき、$u = x^2+1$ と置くと $du = 2x dx$。\nよって $\\int u^3 du = \\frac{1}{4}u^4 + C = \\frac{1}{4}(x^2+1)^4 + C$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：dxの変換を忘れる、定積分の場合は積分範囲を変え忘れる",
                    detail: `
              置換積分を行う際、最も忘れやすいのが $dx$ を $du$ に変換することです。
              $du = g'(x) dx$ の関係を必ず利用しましょう。
              また、定積分の場合は、変数を $x$ から $u$ に変えたら、積分範囲も $x$ の範囲から $u$ の範囲に変換する必要があります。
            `,
                },
                problems: [
                    {
                        question: "$\\int (2x+1)^3 dx$ を求めなさい。",
                        answer: "1/8 (2x+1)^4 + C",
                        hint: "$u = 2x+1$ と置いてみましょう。",
                    },
                    {
                        question: "$\\int x \\sqrt{x^2+1} dx$ を求めなさい。",
                        answer: "1/3 (x^2+1)^(3/2) + C",
                        hint: "$u = x^2+1$ と置いてみましょう。",
                    },
                ],
            },
            {
                title: "部分積分法",
                explanation: `
            積の形をした関数を積分するための公式です。
            $\\int f(x)g'(x) dx = f(x)g(x) - \\int f'(x)g(x) dx$
            この公式を使うには、$f(x)$ と $g'(x)$ を適切に選ぶことが重要です。
            一般的には、微分すると簡単になる関数を $f(x)$、積分しやすい関数を $g'(x)$ に選びます。
          `,
                examples: [
                    {
                        title: "部分積分の例",
                        detail: "$\\int x \\cos x dx$\n$f(x)=x, g'(x)=\\cos x$ とすると $f'(x)=1, g(x)=\\sin x$。\n$\\int x \\cos x dx = x \\sin x - \\int 1 \\cdot \\sin x dx = x \\sin x - (-\\cos x) + C = x \\sin x + \\cos x + C$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：f(x)とg'(x)の選び方を間違える",
                    detail: `
              部分積分法は $f(x)$ と $g'(x)$ の選び方で計算の難易度が大きく変わります。
              例えば、$\\int x e^x dx$ の場合、$f(x)=x, g'(x)=e^x$ と選ぶと計算が楽になります。
              逆に選ぶと、より複雑な積分が出てきてしまいます。
              「ロガリズミック（対数関数）、インバース（逆三角関数）、アルジェブライック（多項式）、トリゴノメトリック（三角関数）、エクスポネンシャル（指数関数）」の順で $f(x)$ を選ぶと良いとされています（Liateの法則）。
            `,
                },
                problems: [
                    {
                        question: "$\\int x e^x dx$ を求めなさい。",
                        answer: "xe^x - e^x + C",
                        hint: "$f(x) = x$, $g'(x) = e^x$ と置いて部分積分公式を適用しましょう。",
                    },
                    {
                        question: "$\\int x \\sin x dx$ を求めなさい。",
                        answer: "-x cos x + sin x + C",
                        hint: "$f(x) = x$, $g'(x) = \\sin x$ と置いて部分積分公式を適用しましょう。",
                    },
                ],
            },
            {
                title: "定積分の概念と計算",
                explanation: `
            定積分は、関数とx軸で囲まれた部分の面積を求めることに対応します。
            不定積分と異なり、積分範囲（下端と上端）が指定され、結果は数値になります。
            $\\int_a^b f(x) dx = [F(x)]_a^b = F(b) - F(a)$
            ここで $F(x)$ は $f(x)$ の原始関数です。
          `,
                examples: [
                    {
                        title: "定積分の例",
                        detail: "$\\int_1^2 x^2 dx = [\\frac{1}{3}x^3]_1^2 = \\frac{1}{3}(2^3) - \\frac{1}{3}(1^3) = \\frac{8}{3} - \\frac{1}{3} = \\frac{7}{3}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：計算ミスや符号ミス",
                    detail: `
              定積分の計算では、$F(b) - F(a)$ の引き算の順序や、負の数の計算での符号ミスがよく発生します。
              特に、原始関数を求めた後に代入する値を間違えたり、引き算の際に括弧を付け忘れたりしないように注意しましょう。
            `,
                },
                problems: [
                    {
                        question: "$\\int_0^1 (x^2 + 1) dx$ を計算しなさい。",
                        answer: "4/3",
                        hint: "まず不定積分を求め、その後で上端と下端の値を代入して引き算します。",
                    },
                    {
                        question: "$\\int_1^2 (3x^2 - 4x) dx$ を計算しなさい。",
                        answer: "2",
                        hint: "不定積分を求めてから、$[F(x)]_1^2 = F(2) - F(1)$ を計算します。",
                    },
                ],
            },
            {
                title: "面積",
                explanation: `
            定積分は、曲線とx軸、または複数の曲線で囲まれた領域の面積を求めるのにも使われます。
            $x$軸より上にある部分の面積は正、下にある部分の面積は負として計算されます。
            面積を求める場合は、常に正の値になるように絶対値を取ったり、区間を分けたりする必要があります。
            2つの曲線 $y=f(x)$ と $y=g(x)$ で囲まれた面積は、$\\int_a^b |f(x) - g(x)| dx$ で求められます。
          `,
                examples: [
                    {
                        title: "面積の例",
                        detail: "曲線 $y = x^2$ と $x$軸、直線 $x=1$ で囲まれた面積は $\\int_0^1 x^2 dx = \\frac{1}{3}$",
                    },
                    {
                        title: "x軸より下の面積",
                        detail: "曲線 $y = x^2 - 1$ と $x$軸で囲まれた部分の面積は、区間 $[-1, 1]$ で $y \\le 0$ なので、$\\int_{-1}^1 -(x^2 - 1) dx = \\frac{4}{3}$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：x軸より下の部分の符号を考慮しない",
                    detail: `
              面積は常に正の値です。関数がx軸の下にある区間では、定積分の値は負になります。
              この場合、その区間の定積分の値に絶対値をつけるか、$-f(x)$ を積分するようにしましょう。
              また、複数の曲線で囲まれる場合は、どちらの関数が上にあるかを区間ごとに確認しましょう。
            `,
                },
                problems: [
                    {
                        question:
                            "曲線 $y = x^2 - 1$ と $x$軸で囲まれた部分の面積を求めなさい。",
                        answer: "4/3",
                        hint: "曲線がx軸と交わる点を求め、その区間で積分します。x軸より下の部分の符号に注意しましょう。",
                    },
                    {
                        question:
                            "2つの曲線 $y = x^2$ と $y = x+2$ で囲まれた部分の面積を求めなさい。",
                        answer: "9/2",
                        hint: "2つの曲線の交点を求め、どちらの関数が上にあるかを確認して積分します。",
                    },
                ],
            },
            {
                title: "体積",
                explanation: `
            積分は、図形を回転させてできる立体の体積を求めるのにも使われます（回転体の体積）。
            関数 $y=f(x)$ を $x$軸の周りに回転させてできる立体の体積は、
            $\\int_a^b \\pi (f(x))^2 dx$ で求められます。
            これは、円の面積 $\\pi r^2$ を積み重ねていくイメージです。
          `,
                examples: [
                    {
                        title: "回転体の体積の例",
                        detail: "曲線 $y = x$ ($0 \\le x \\le 1$) を $x$軸の周りに回転させてできる立体の体積は $\\int_0^1 \\pi (x)^2 dx = \\frac{1}{3}\\pi$",
                    },
                ],
                pitfall: {
                    title: "よくある間違い：公式の適用ミス",
                    detail: `
              体積の公式で $\\pi$ を掛け忘れたり、$f(x)$ を二乗し忘れたりすることがよくあります。
              また、回転軸が $x$軸以外の場合や、2つの曲線間の回転体の体積を求める場合は、公式が少し変わるため注意が必要です。
              公式の意味を理解し、正しく適用することが大切です。
            `,
                },
                problems: [
                    {
                        question:
                            "曲線 $y = \\sqrt{x}$ と $x$軸、直線 $x=1$ で囲まれた部分を $x$軸の周りに回転させてできる立体の体積を求めなさい。",
                        answer: "π/2",
                        hint: "公式 $\\int_a^b \\pi (f(x))^2 dx$ を使います。$f(x) = \\sqrt{x}$ です。",
                    },
                    {
                        question:
                            "曲線 $y = x^2$ と直線 $y=x$ で囲まれた部分を $x$軸の周りに回転させてできる立体の体積を求めなさい。",
                        answer: "2π/15",
                        hint: "2つの曲線で囲まれた領域を回転させる場合、外側の半径の二乗から内側の半径の二乗を引いたものを積分します。",
                    },
                ],
            },
        ],
    },
];

// 全ての科目のデータをまとめる
const allSubjectsData: SubjectData = {
    数学I: math1Lessons,
    数学A: mathALessons,
    数学II: math2Lessons,
    数学B: mathBLessons,
    数学III: math3Lessons, // 既存の微分積分コンテンツを数学IIIとして利用
};

export default allSubjectsData;
